<div class="show-card shadow">
  <div class="show-header">
<header>
  <h1><%= @merchant.name %></h1>
</header>
<a href="./<%= @merchant.id %>/edit" class="small-button"><i class="far fa-edit">&nbsp;</i>Edit</a>
</div>

<div class="merchant-insight">
  <h3>Insight</h3>
  <br>
  <p>You've spent <b><%= @budget.pretty_value(@merchant) %></b> so far this month at <%= @merchant.name %></p>
  <p> The largest transaction you've made with them was ...
</div>
</div>

<div class="table-container flex">
<table>
  <tr>
    <th>Date</th>
    <th>Merchant</th>
    <th>Category</th>
    <th>Description</th>
    <th>Amount</th>
  </tr>
  <% for transaction in @transactions %>
    <% if transaction.merchant_id == @merchant.id %>
    <tr>
      <td><a href="../transactions/<%= transaction.id %>"><%= transaction.pretty_date %></a></td>
      <td><a href="../transactions/<%= transaction.id %>"><%= transaction.merchant.name %></a></td>
      <td><a href="../transactions/<%= transaction.id %>"><%= transaction.category.name.capitalize %></a></td>
      <td><a href="../transactions/<%= transaction.id %>"><%= transaction.pretty_description %></a></td>
      <td class="amount"><a href="../transactions/<%= transaction.id %>"><%= transaction.pretty_value %></a></td>
    </tr>
    <% end %>
  <% end %>
  <tfoot>
    <td colspan="4" class="empty"></td>
    <td class="sum">
      <% pounds = 0 %>
      <% pence = 0 %>
      <% @transactions.each do |transaction| %>
        <% if transaction.merchant_id == @merchant.id %>
          <% pounds += transaction.pounds %>
          <% pence += transaction.pence %>
        <% end %>
      <% end %>
      <% pounds += pence / 100 %>
      <% pence %= 100 %>
      <%= pence < 10 ? "£#{pounds}.0#{pence}" : "£#{pounds}.#{pence}" %>
    </td>
  </tfoot>
</table>
</div>
</div>
